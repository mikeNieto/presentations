<br /><br /><br /><br /><br /><br /><br />
<h2><em>/* Release and Deploy */</em></h2>
<h2>
    Containers - Kubernetes - Helm - Jenkins(2/X)
</h2>

---
<h2>Containers</h2>

---
<h2>Containers</h2>
<h2><em>Docker</em></h2>

---
<h1>Docker</h1>
<img src="/images/containers/architecture-docker-components.png" />

---
<h1>Docker - Containers vs Virtual machines</h1>
<br /><br /><br />
<img src="/images/containers/containers-vs-vm.png" />
<style>
    img {
        height: 70%;
    }
</style>

---
<h1>Docker - Layers</h1>
<img src="/images/containers/container-layers.jpg" />
<br /><br />
<style>
    img {
        height: 80%;
    }
</style>

---

<h1>Containers</h1>
<h2>What is a <em>container</em>?</h2>

---

<h1>Container - Technical</h1>

<h3>Thin wrapper around Linux Container technology.</h3>
<h3>
    Leverages 4 functionalities from Linux to provide an isolated environment
</h3>
<div>
    <ul>
        <li>namespaces - visibility (pid)</li>
        <li>cgroups - control groups (resources)</li>
        <li>union filesystem - data</li>
        <li>seccomp - security profiles</li>
    </ul>
</div>
<style>
    div{
        margin-left: auto;
        margin-right: auto;
        display: table;
    }
    li {
        text-align: left;
    }
</style>

---
<h1>Containers - nameservers</h1>

<split-view>
    <div>
        <br /><br /><br />
        <h4><em>Creating a isolated process</em></h4>
        <h4>unshare --fork --pid --mount-proc bash</h4>
    </div>
    <web-term path="folder"></web-term>
</split-view>

---
<h1>Containers - cgroups (1)</h1>

<split-view>
    <div>
        <h4><em>install cgroups libs</em></h4>
        <h4>apt-get install libcgroup1 cgroup-tools</h4>
        <h4><em>create an executable file</em></h4>
        <h4>test.sh</h4>
    </div>

    <source-code folder="sources" files="test.sh" start-lines="" end-lines="">
    </source-code>
</split-view>
<style>
h4:first-of-type {
    margin-top: 4vw;
}
</style>
---
<h1>Containers - cgroups(2) - test.sh</h1>

<split-view>
    <div>
        <h4><em>#create a cgroup foo#</em></h4>
        <h4>cgcreate -g memory:foo</h4>
        <h4><em>#assign 50000 of memory#</em></h4>
        <h4>echo 50000 | tee /sys/fs/cgroup/memory/foo/memory.limit_in_bytes</h4>
        <h4><em>#check the allocation#</em></h4>
        <h4>cat /sys/fs/cgroup/memory/foo/memory.limit_in_bytes</h4>
        <h4><em>#execute the process#</em></h4>
        <h4>cgexec -g memory:foo ./test.sh</h4>
        <h4><em>#delete the cgroup</em></h4>
        <h4>cgdelete memory:foo</h4>
    </div>

    <web-term path="sources"></web-term>
    </source-code>
</split-view>
---
<h1>Containers - Union File Systems (1)</h1>
<br /><br /><br /><br /><br /><br /><br /><br />
<img src="/images/containers/overlay_constructs.jpg" />

<style>
    img {
        height: 40%;
    }
</style>


---
<h1>Containers - Union File Systems (2)</h1>

<split-view>
    <div>
        <h4><em>#create 4 folders#</em></h4>
        <h4>mkdir base diff overlay workdir</h4>
        <h4><em>#create a base file#</em></h4>
        <h4>echo "this is my base layer" > base/file1</h4>
        <h4><em>#create the overlay (new layer)#</em></h4>
        <h4>mount -t overlay -o lowerdir=base,upperdir=diff,workdir=workdir none overlay</h4>
        <h4><em>#Umount the overlay#</em></h4>
        <h4>sudo umount overlay</h4>
        <h4><em>#remoe all#</em></h4>
        <h4>rm -Rf base diff overlay workdir</h4>
    </div>

    <web-term path="/ufiles"></web-term>
</split-view>
---
<div>
    <img src="/images/k8s/Kubernetes_logo.png" />
</div>
<style>
    img{
        margin-top: 10em;
        width: 60%;
        height: 60%;
    }
</style>
---
<h1>History</h1>
<img src="/images/k8s/borg-cgroups.png" />
<style>
    #top {
        background-color: white;
    }
</style>
---
<h1>Whole datacenter as a single deployment platform</h1>

<img id="img" src="/images/k8s/single-deployment.jpg" />
<style>
    #top {
        background-color: white;
    }
    #img{
        margin-top: 5em;
        width: 80%;
        height: 65%;
    }
</style>

---
<h1>Components</h1>

<img id="img" src="/images/k8s/k8s-components.jpg" />
<style>
    #top {
        background-color: white;
    }
    #img{
        margin-top: 5em;
        width: 80%;
        height: 65%;
    }
</style>

---
<h1>Basic overview</h1>

<img id="img" src="/images/k8s/basic-overview.jpg" />
<style>
    #top {
        background-color: white;
    }
    #img{
        margin-top: 2em;
        width: 75%;
        height: 75%;
    }
</style>

---
<h1>Cloud Providers</h1>

<img id="img" src="/images/k8s/cloud-providers.png" />
<style>
    #top {
        background-color: white;
    }
    #img{
        margin-top: 2em;
        width: 75%;
        height: 75%;
    }
</style>

---

<h1>or Minikube</h1>

<h3>
        curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
        && chmod +x minikube
</h3>
<br/><br/><br/>
<h3>
        sudo cp minikube /usr/local/bin && rm minikube
</h3>

---

<h1>Starting minikube locally -> "minikube start --vm-driver=none"</h1>
<split-view>
    <web-term path=""></web-term>
</split-view>

---

<h1>Minikube dashboard -> "kubectl proxy"</h1>

<split-view>
    <web-term path=""></web-term>
    <web-browser src="http://127.0.0.1:8001/api/v1/namespaces/kube-system/services/http:kubernetes-dashboard:/proxy/"></web-browser>
</split-view>

---



















---
<h1>Snapshot</h1>

<img src="/images/bazel.png" />
<img id="qr" src="/qrcode?url=https://bazel.build/" />

---

<h1>Terminal</h1>

<split-view>
    <web-term path="folder"></web-term>
</split-view>

---

<h1>
    Shell &amp; Browser -
    <strong>Type `python -m SimpleHTTPServer` in the shell window</strong>
</h1>

<split-view>
    <web-term path="folder"></web-term>
    <web-browser src="http://"></web-browser>
</split-view>

---
<h1>
    Browser
</h1>

<split-view>
    <web-browser
        src="http://10.101.93.128:8080/job/CICD-backendApp/"
    ></web-browser>
</split-view>

---
<script src="/js/draw.js"></script>
<h1>Code samples</h1>

<split-view>
    <web-term path="folder"></web-term>
    <source-code
        folder="sources"
        files="main.go pod.yaml"
        start-lines="26;18,21"
        end-lines="27;18,22"
    >
    </source-code>
</split-view>

---

<h1>Draw on slides</h1>

<p>
    On the left border of the page there's a pen that can be used to draw on the
    slides. Type <em>&lt;ESC&gt;</em> to exit draw mode.
</p>

<img src="/images/bazel.png" />
<script src="/js/draw.js"></script>

<style>
    img {
        height: 75%;
    }
</style>
